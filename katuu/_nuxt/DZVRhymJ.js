import{d as P,O as j,L as F,r as p,j as J,t as m,W as f,A as o,z as l,S as i,X as K,x as y,Y as h,v as q,Q as G,R as W,y as Z,Z as Q,_ as $,$ as x,N as T,a0 as X,a1 as Y}from"./CcToJEy3.js";import{a as H,d as b,e as ee,f as S,g as ae,h as z}from"./BHtrGYCv.js";import{V as w,a as V,b as le,c as N,d as te,e as se,f as _,g as ne}from"./BKSLDj76.js";import{a as ie,V as D}from"./B2FoI3GA.js";const oe={style:{height:"40px",display:"flex","align-items":"center"}},ue={style:{color:"#1976D2"}},ve=P({__name:"ModalEdit",setup(de,{expose:U}){j({apiKey:"AIzaSyD2B0zCpxtQcPNoyTAyVePabbZrsvMfvs4",authDomain:"nuxt-blog-4bf26.firebaseapp.com",databaseURL:"https://nuxt-blog-4bf26.firebaseio.com",projectId:"nuxt-blog-4bf26",storageBucket:"nuxt-blog-4bf26.appspot.com",messagingSenderId:"93634015500",appId:"1:93634015500:web:9cabc4347b0835340bd929",measurementId:"G-7WLZ5RDWE2"});const g=F(),v=p(!1),u=p({1:{name:"Trân Châu Đen",price:5e3,isChecked:!1},2:{name:"Trân Châu Trắng",price:5e3,isChecked:!1},3:{name:"Trân Châu Dừa",price:5e3,isChecked:!1},4:{name:"Pudding Trứng",price:5e3,isChecked:!1},5:{name:"Pudding Socola",price:5e3,isChecked:!1},6:{name:"Sương Sáo",price:5e3,isChecked:!1},7:{name:"Rau Câu Phô Mai",price:5e3,isChecked:!1},8:{name:"Phô Mai Tươi",price:5e3,isChecked:!1},9:{name:"Thạch Táo",price:5e3,isChecked:!1},10:{name:"Khúc Bạch",price:5e3,isChecked:!1},11:{name:"Chân Mèo",price:5e3,isChecked:!1},12:{name:"Đào miếng",price:7e3,isChecked:!1},13:{name:"Trái nhãn",price:7e3,isChecked:!1},14:{name:"Trái vải",price:7e3,isChecked:!1},15:{name:"Kem machiato",price:7e3,isChecked:!1},16:{name:"Kem trứng cháy",price:7e3,isChecked:!1},17:{name:"Full topping",price:1e4,isChecked:!1}}),t=p({}),c=p(1),r=p(""),n=p(""),A=J(()=>c.value&&n.value?n.value*c.value:n.value),I=a=>new Intl.NumberFormat("vi-VN").format(a)+" đ",M=a=>{let e=0;Object.entries(u.value).forEach(d=>{d[1].isChecked&&(e+=d[1].price)}),n.value=t.value.size[t.value.size.isActive]+e},O=a=>{console.log(u.value,a),u.value[a].isChecked?n.value+=u.value[a].price:n.value=n.value-u.value[a].price},B=async a=>{t.value={},await Q(),v.value=!0,t.value=JSON.parse(JSON.stringify(a)),t.value.id=a.id,console.log(a),a.type?n.value=a.price:(c.value=a.quantity,n.value=t.value.size[t.value.size.isActive],JSON.parse(a.topping).forEach(e=>{Object.entries(u.value).forEach((d,s)=>{d[1].name===e.name&&(u.value[s+1].isChecked=e.isChecked,n.value+=e.price)})})),r.value=a.comment},L=async()=>{await $(x(T(g,"products"),t.value.id)),C()},R=async()=>{let a=[];Object.entries(u.value).filter(d=>{d[1].isChecked&&a.push(d[1])});let e={name:t.value.name,comment:r.value,time:X(),price:parseInt(n.value)};t.value.type?e.type=t.value.type:(e.size=t.value.size,e.topping=JSON.stringify(a),e.quantity=c.value),await Y(x(T(g,"products"),t.value.id),e),C()},C=()=>{c.value=1,r.value="",n.value=0,Object.entries(u.value).forEach(a=>{a[1].isChecked=!1}),v.value=!1};return U({showModal:B}),(a,e)=>(m(),f(ne,{modelValue:i(v),"onUpdate:modelValue":e[6]||(e[6]=d=>h(v)?v.value=d:null),"max-width":"600",scrollable:""},{default:o(({isActive:d})=>[l(H,{"prepend-icon":"mdi-cart",title:i(t).name},{default:o(()=>[l(w,{class:"mt-3"}),l(b,{class:"px-4",style:{height:"300px"}},{default:o(()=>[i(t).size?(m(),f(b,{key:0},{default:o(()=>[l(V,null,{default:o(()=>[l(le,{modelValue:i(t).size.isActive,"onUpdate:modelValue":s=>i(t).size.isActive=s,inline:"",onChange:e[0]||(e[0]=s=>M(s))},{default:o(()=>[l(N,{label:"Size M",value:"M"}),i(t).size.L?(m(),f(N,{key:0,label:"Size L",value:"L"})):K("",!0)]),_:2},1032,["modelValue","onUpdate:modelValue"]),y("div",oe,[l(ie,{icon:"mdi-delete",size:"x-large",color:"red",onClick:L})])]),_:2},1024),l(V,null,{default:o(()=>[l(i(te),{width:200,modelValue:i(c),"onUpdate:modelValue":e[1]||(e[1]=s=>h(c)?c.value=s:null),min:1,reverse:!1,controlVariant:"split",label:"Số Lượng",hideInput:!1,inset:"",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(V,{dense:""},{default:o(()=>[(m(!0),q(G,null,W(i(u),(s,E)=>(m(),f(se,{modelValue:s.isChecked,"onUpdate:modelValue":k=>s.isChecked=k,label:s.name,onChange:k=>O(E),"hide-details":""},null,8,["modelValue","onUpdate:modelValue","label","onChange"]))),256))]),_:1}),l(V,null,{default:o(()=>[l(_,{label:"Note",modelValue:i(r),"onUpdate:modelValue":e[2]||(e[2]=s=>h(r)?r.value=s:null),name:"input-7-1",variant:"filled","auto-grow":""},null,8,["modelValue"])]),_:1})]),_:2},1024)):(m(),f(b,{key:1},{default:o(()=>[l(ee,null,{default:o(()=>[l(S,{modelValue:i(t).name,"onUpdate:modelValue":e[3]||(e[3]=s=>i(t).name=s),label:"Tên bánh:"},null,8,["modelValue"]),l(S,{inputmode:"numeric",type:"number",modelValue:i(n),"onUpdate:modelValue":e[4]||(e[4]=s=>h(n)?n.value=s:null),label:"Giá: "+I(i(n))},null,8,["modelValue","label"]),l(_,{label:"Note",modelValue:i(r),"onUpdate:modelValue":e[5]||(e[5]=s=>h(r)?r.value=s:null),name:"input-7-1",variant:"filled","auto-grow":""},null,8,["modelValue"])]),_:1})]),_:1}))]),_:2},1024),l(w),l(ae,null,{default:o(()=>[l(D,{text:"Close",onClick:C}),l(z),y("div",ue,Z(i(A)),1),l(z),l(D,{color:"surface-variant",text:"Save",variant:"flat",onClick:R})]),_:1})]),_:2},1032,["title"])]),_:1},8,["modelValue"]))}});export{ve as _};
